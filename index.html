<!doctype html>
<html lang="he" dir="rtl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>שילוט מהודר בהדר · תומר קמרלינג</title>
  <meta name="description" content="גלריה של 12 תמונות מבתי עסק בהדר חיפה, עם תצוגה מוגדלת, ניווט חיצים וטופס לשליחת מידע על כל תמונה." />
  <style>
    :root { --gap:18px; --radius:12px; --maxw:1200px; }
    *{box-sizing:border-box}
    html,body{margin:0;background:#fff;color:#111;font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial}
    a{color:#0d6efd;text-decoration:none}a:hover{text-decoration:underline}
    header{position:sticky;top:0;background:#fff;border-bottom:1px solid #eee;z-index:10}
    .wrap{max-width:var(--maxw);margin:0 auto;padding:14px 16px}
    .brand{display:flex;flex-wrap:wrap;gap:10px;align-items:center}
    .brand h1{margin:0;font-size:clamp(22px,3.2vw,34px)}
    .subtitle{color:#666;font-size:14px}
    nav{margin-top:10px;display:flex;gap:8px}
    .tab{appearance:none;border:1px solid #e5e5e5;background:#fafafa;padding:8px 12px;border-radius:999px;cursor:pointer;font-weight:600}
    .tab[aria-current="page"]{background:#111;color:#fff;border-color:#111}

    main{max-width:var(--maxw);margin:24px auto;padding:0 16px 48px}
    .grid{display:grid;gap:var(--gap);grid-template-columns:repeat(1,1fr)}
    @media(min-width:700px){.grid{grid-template-columns:repeat(2,1fr)}}
    @media(min-width:1030px){.grid{grid-template-columns:repeat(3,1fr)}}

    .card{border:1px solid #eee;border-radius:var(--radius);overflow:hidden;background:#fff;box-shadow:0 1px 2px rgba(0,0,0,.04)}
    .thumb{position:relative;display:block;overflow:hidden;background:#f6f6f6}
    .thumb img{width:100%;height:100%;display:block;object-fit:cover;transition:transform .2s ease}
    .thumb:hover img{transform:scale(1.02)}
    .card-body{padding:10px;display:flex;align-items:center;justify-content:space-between;gap:8px}
    .title{font-weight:700}
    .btn{padding:8px 12px;border-radius:10px;border:1px solid #111;background:#111;color:#fff;cursor:pointer;font-weight:700}

    /* Lightbox */
    .lightbox{position:fixed;inset:0;background:rgba(0,0,0,.86);display:none;align-items:center;justify-content:center;z-index:50}
    .lightbox.open{display:flex}
    .lb-stage{position:relative;width:min(96vw,1200px);height:min(88vh,900px);display:flex;align-items:center;justify-content:center}
    .lb-img{max-width:100%;max-height:100%;object-fit:contain;border-radius:10px;background:#000;box-shadow:0 10px 30px rgba(0,0,0,.35)}
    .lb-close{position:absolute;top:8px;left:8px;background:#fff;border:none;border-radius:999px;padding:6px 10px;cursor:pointer;font-weight:800}
    .lb-nav{position:absolute;inset:0;display:flex;align-items:center;justify-content:space-between;pointer-events:none}
    .lb-arrow{pointer-events:auto;border:none;background:rgba(255,255,255,.95);width:42px;height:42px;border-radius:999px;font-size:20px;display:grid;place-items:center;cursor:pointer}
    .lb-caption{position:absolute;bottom:8px;right:8px;left:8px;background:rgba(255,255,255,.95);padding:8px 12px;border-radius:10px;font-weight:600;color:#111}

    /* Form popup */
    .formbox{position:fixed;inset:0;background:rgba(0,0,0,.85);display:none;align-items:center;justify-content:center;z-index:60}
    .formbox.open{display:flex}
    .form{background:#fff;border-radius:14px;max-width:560px;width:94%;padding:16px 16px 18px;box-shadow:0 10px 30px rgba(0,0,0,.25)}
    .form-h{display:flex;gap:12px;align-items:center;margin-bottom:10px}
    .form-h img{width:80px;height:60px;object-fit:cover;border-radius:8px;border:1px solid #eee}
    .form-h .ttl{font-weight:800}
    form.comment{display:grid;gap:10px}
    input,textarea{width:100%;padding:10px;border:1px solid #ddd;border-radius:10px;font:inherit}
    input[type=file]{border-style:dashed;background:#fcfcfc}
    .actions{display:flex;gap:8px;align-items:center}
    .btn.ghost{background:#fff;color:#111;border:1px solid #bbb}

    .sr-only{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);white-space:nowrap;border:0}
  </style>
</head>
<body>
  <header>
    <div class="wrap">
      <div class="brand">
        <h1>שילוט מהודר בהדר</h1>
        <div class="subtitle">תומר קמרלינג </div>
      </div>
      <nav aria-label="ניווט עליון">
        <button class="tab" aria-current="page" onclick="location.href='index.html'">גלריה</button>
        <a class="tab" href="about.html">עוד מידע על הפרוייקט</a>
      </nav>
    </div>
  </header>

  <main>
    <section aria-label="גלריית תמונות">
      <div class="grid" id="grid"></div>
    </section>
  </main>

  <!-- Lightbox -->
  <div class="lightbox" id="lightbox" aria-hidden="true" role="dialog" aria-label="תצוגת תמונה מוגדלת">
    <div class="lb-stage">
      <button class="lb-close" title="סגירה (Esc)" onclick="closeLightbox()">✕</button>
      <img id="lbImg" class="lb-img" alt="תמונה מוגדלת" />
      <div class="lb-caption" id="lbCaption"></div>
      <div class="lb-nav">
        <button class="lb-arrow" aria-label="תמונה קודמת" onclick="navLightbox(-1)">◀</button>
        <button class="lb-arrow" aria-label="תמונה הבאה" onclick="navLightbox(1)">▶</button>
      </div>
    </div>
  </div>

  <!-- Form Popup -->
  <div class="formbox" id="formbox" aria-hidden="true" role="dialog" aria-label="טופס הוספת מידע על תמונה">
    <div class="form">
      <div class="form-h">
        <img id="formThumb" alt="תצוגה מקדימה" />
        <div>
          <div class="ttl" id="formTitle">—</div>
          <div style="font-size:12px;color:#666">המידע יישלח עבור התמונה שנבחרה</div>
        </div>
      </div>
      <form id="imageForm" class="comment" onsubmit="handleCommentSubmit(event)">
        <input type="hidden" id="imageIndex" name="imageIndex" />
        <label class="sr-only" for="name">שם מלא</label>
        <input id="name" name="name" type="text" placeholder="שם מלא" required />
        <label class="sr-only" for="email">אימייל</label>
        <input id="email" name="email" type="email" placeholder="אימייל" required />
        <label class="sr-only" for="phone">טלפון נייד</label>
        <input id="phone" name="phone" type="tel" placeholder="טלפון נייד" />
        <label class="sr-only" for="note">הערה</label>
        <textarea id="note" name="note" placeholder="הערה/סיפור על העסק"></textarea>
        <input name="file" type="file" accept="image/*,.pdf" />
        <div class="actions">
          <button type="submit" class="btn">שליחה</button>
          <button type="button" class="btn ghost" onclick="closeForm()">סגירה</button>
          <span style="font-size:12px;color:#777">* כרגע דמו – יש לחבר יעד שליחה ב‑fetch</span>
        </div>
      </form>
    </div>
  </div>

  <script>
    // === Image list (points to your optimized files in assets/grid and assets/full) ===
    const IMAGES = Array.from({length:12}, (_,i)=>{
      const id = String(i+1).padStart(2,'0');
      return {
        title: `בית עסק #${i+1}`,
        grid: `assets/grid/photo${id}_grid.webp`,
        full: `assets/full/photo${id}_full.webp`
      };
    });

    // Build cards (3×4) with responsive thumbnails
    const grid = document.getElementById('grid');
    grid.innerHTML = IMAGES.map((img,i)=>{
      return `
        <article class="card" data-index="${i}">
          <a href="#" class="thumb" onclick="openLightbox(${i});return false;" aria-label="הגדלת תמונה ${i+1}">
            <img
              src="${img.grid}"
              srcset="${img.grid} 800w, ${img.full} 1800w"
              sizes="(max-width:1029px) 50vw, 33vw"
              loading="lazy" decoding="async"
              alt="${escapeHtml(img.title)}" />
          </a>
          <div class="card-body">
            <div class="title">${escapeHtml(img.title)}</div>
            <button class="btn" onclick="openForm(${i})">לחץ כאן כדי להוסיף מידע</button>
          </div>
        </article>`;
    }).join('');

    // Lightbox logic
    const lightbox = document.getElementById('lightbox');
    const lbImg = document.getElementById('lbImg');
    const lbCaption = document.getElementById('lbCaption');
    let current = 0;

    function openLightbox(i){ current=i; updateLightbox(); lightbox.classList.add('open'); lightbox.setAttribute('aria-hidden','false'); document.body.style.overflow='hidden'; }
    function closeLightbox(){ lightbox.classList.remove('open'); lightbox.setAttribute('aria-hidden','true'); document.body.style.overflow=''; }
    function navLightbox(d){ current=(current+d+IMAGES.length)%IMAGES.length; updateLightbox(); }
    function updateLightbox(){ lbImg.src = IMAGES[current].full; lbCaption.textContent = IMAGES[current].title + ` (תמונה ${current+1} מתוך ${IMAGES.length})`; }
    lightbox.addEventListener('click', e=>{ if(e.target===lightbox) closeLightbox(); });
    document.addEventListener('keydown', e=>{ if(!lightbox.classList.contains('open')) return; if(e.key==='Escape') closeLightbox(); if(e.key==='ArrowRight') navLightbox(1); if(e.key==='ArrowLeft') navLightbox(-1); });

    // Form popup logic
    const formbox = document.getElementById('formbox');
    const formThumb = document.getElementById('formThumb');
    const formTitle = document.getElementById('formTitle');
    const imageIndexInput = document.getElementById('imageIndex');

    function openForm(i){ imageIndexInput.value=i; formThumb.src=IMAGES[i].grid; formTitle.textContent=IMAGES[i].title; formbox.classList.add('open'); formbox.setAttribute('aria-hidden','false'); document.body.style.overflow='hidden'; }
    function closeForm(){ formbox.classList.remove('open'); formbox.setAttribute('aria-hidden','true'); document.body.style.overflow=''; }
    formbox.addEventListener('click', e=>{ if(e.target===formbox) closeForm(); });

    function handleCommentSubmit(ev){ ev.preventDefault(); const data=new FormData(ev.target); console.log('COMMENT', Object.fromEntries(data.entries())); alert('הטופס נקלט (דמו). חברו יעד שליחה.'); ev.target.reset(); closeForm(); }

    function escapeHtml(str){ return String(str).replace(/[&<>\"]/g, s=>({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;'}[s])); }
  </script>
</body>
</html>
